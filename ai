import java.time.DayOfWeek;
import java.time.LocalTime;
import java.time.ZoneId;
import java.time.ZonedDateTime;

public final class AmPmIndicator {

    private static final ZoneId ET = ZoneId.of("America/New_York");

    // Time windows from your Mule logic
    private static final LocalTime MIDNIGHT_START = LocalTime.of(0, 0, 0, 0);
    private static final LocalTime MIDNIGHT_END   = LocalTime.of(20, 59, 59, 999_000_000); // 20:59:59.999

    private static final LocalTime BUS_START      = LocalTime.of(21, 0, 0, 0);             // 21:00:00.000
    private static final LocalTime BUS_END        = LocalTime.of(23, 59, 59, 999_000_000); // 23:59:59.999

    private AmPmIndicator() {}

    /**
     * Equivalent to Mule:
     * amPmInd =
     *   if (((isWeekday and isMidnight) or isWeekend)) 'A'
     *   else if (isWeekday and isBusHours) 'P'
     *   else ""
     */
    public static String computeAmPmIndNowEt() {
        ZonedDateTime nowEt = ZonedDateTime.now(ET);
        return computeAmPmInd(nowEt.toLocalTime(), nowEt.getDayOfWeek());
    }

    public static String computeAmPmInd(LocalTime currentTime, DayOfWeek dayOfWeek) {
        boolean isWeekday = dayOfWeek != DayOfWeek.SATURDAY && dayOfWeek != DayOfWeek.SUNDAY;

        boolean isMidnightWindow = isBetweenInclusive(currentTime, MIDNIGHT_START, MIDNIGHT_END);
        boolean isBusHoursWindow = isBetweenInclusive(currentTime, BUS_START, BUS_END);

        boolean isWeekend = (dayOfWeek == DayOfWeek.SATURDAY || dayOfWeek == DayOfWeek.SUNDAY)
                && isBetweenInclusive(currentTime, MIDNIGHT_START, BUS_END);

        if ((isWeekday && isMidnightWindow) || isWeekend) {
            return "A";
        } else if (isWeekday && isBusHoursWindow) {
            return "P";
        }
        return "";
    }

    private static boolean isBetweenInclusive(LocalTime t, LocalTime start, LocalTime end) {
        return !t.isBefore(start) && !t.isAfter(end);
    }
}