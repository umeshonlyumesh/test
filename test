public void listen(List<ConsumerRecord<String, String>> records) {

    long startTime = System.currentTimeMillis();
    int totalRecordSize = 0;
    int totalProcessedCount = 0;

    if (records == null || records.isEmpty()) {
        CPSLogger.warn(
            log,
            CPS_KAFKA_CONSUMER_APP_EVENT,
            "Received empty batch from CPS Kafka publisher"
        );
        return;
    }

    CPSLogger.info(
        log,
        CPS_KAFKA_CONSUMER_APP_EVENT,
        CPSLogger.fillPlaceHolders(
            "Received batch with {} Kafka records",
            records.size()
        )
    );

    for (ConsumerRecord<String, String> msg : records) {

        if (msg == null || msg.value() == null) {
            CPSLogger.warn(
                log,
                CPS_KAFKA_CONSUMER_APP_EVENT,
                "Skipping null/empty Kafka record"
            );
            continue;
        }

        String messageKey = msg.key();

        try {
            List<CpsPaymentData> cpsPaymentSchemaList =
                    objectMapper.readValue(
                        msg.value(),
                        new TypeReference<List<CpsPaymentData>>() {}
                    );

            int recordSize = cpsPaymentSchemaList.size();
            totalRecordSize += recordSize;

            CPSLogger.debug(
                log,
                CPS_KAFKA_CONSUMER_APP_EVENT,
                CPSLogger.fillPlaceHolders(
                    "Received {} records for message key: {}",
                    recordSize,
                    messageKey
                )
            );

            for (CpsPaymentData cpsPaymentData : cpsPaymentSchemaList) {
                cpsTransactionMessageProcessor.process(cpsPaymentData);
                totalProcessedCount++;
            }

        } catch (Exception e) {
            CPSLogger.error(
                log,
                CPS_KAFKA_CONSUMER_APP_EVENT,
                CPSLogger.fillPlaceHolders(
                    "Failed to process messages for key: {}",
                    messageKey
                ),
                e
            );
            // TODO: discuss failure handling (DLQ / retry / seek)
        }
    }

    long elapsedTime = System.currentTimeMillis() - startTime;

    CPSLogger.info(
        log,
        CPS_KAFKA_CONSUMER_APP_EVENT,
        CPSLogger.fillPlaceHolders(
            "Successfully processed {} records out of {} in {} ms",
            totalProcessedCount,
            totalRecordSize,
            elapsedTime
        )
    );
}