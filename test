private void sendToDlq(
        String originalTopic,
        String key,
        ProducerRecord<String, Object> originalRecord,
        Exception cause,
        CompletableFuture<RecordMetadata> fut
) {
    String dlqTopic = dlqTopic(originalTopic);
    ensureTopic(dlqTopic);

    ProducerRecord<String, Object> dlqRecord =
            new ProducerRecord<>(dlqTopic, key, originalRecord.value());

    // OPTIONAL: Add headers for debugging
    dlqRecord.headers()
            .add("dlq-original-topic", originalTopic.getBytes())
            .add("dlq-exception", cause.getClass().getName().getBytes())
            .add("dlq-message", String.valueOf(cause.getMessage()).getBytes());

    getProducer().send(dlqRecord, (md, dlqEx) -> {
        if (dlqEx != null) {
            fut.completeExceptionally(dlqEx);
        } else {
            fut.complete(md);
        }
    });
}