package com.truist.core.fraud.util;

import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

/**
 * Unit tests for {@link DateFormatNormalizer}.
 */
class DateFormatNormalizerTest {

    @Test
    @DisplayName("Should convert yyyy-MM-dd HH:mm:ss.SSS to ISO format with zone")
    void testNormalize_YyyyMmDdHHmmssSSS() {
        String input = "2025-11-07 15:26:21.211";
        String output = DateFormatNormalizer.normalize(input);

        assertNotNull(output);
        assertTrue(output.startsWith("2025-11-07T15:26:21.211"),
                "Output should start with date and time portion");
        assertTrue(output.contains("T"),
                "Output should contain 'T' separator between date and time");
    }

    @Test
    @DisplayName("Should convert M/d/yyyy to ISO start-of-day format")
    void testNormalize_Mdyyyy() {
        String input = "7/19/2019";
        String output = DateFormatNormalizer.normalize(input);

        assertEquals("2019-07-19T00:00:00.000-04:00", output,
                "Expected normalized date at start of day with timezone");
    }

    @Test
    @DisplayName("Should normalize ISO date with timezone offset (XXX)")
    void testNormalize_IsoWithTimezone() {
        String input = "2025-03-03T10:22:15.123-04:00";
        String output = DateFormatNormalizer.normalize(input);

        assertEquals("2025-03-03T10:22:15.123-04:00", output);
    }

    @Test
    @DisplayName("Should normalize ISO date in UTC (Z)")
    void testNormalize_IsoUtc() {
        String input = "2025-03-03T10:22:15.123Z";
        String output = DateFormatNormalizer.normalize(input);

        assertEquals("2025-03-03T10:22:15.123Z", output);
    }

    @Test
    @DisplayName("Should return empty string for invalid input")
    void testNormalize_InvalidInput() {
        String input = "NotADate";
        String output = DateFormatNormalizer.normalize(input);

        assertEquals("", output, "Expected empty string for invalid date format");
    }

    @Test
    @DisplayName("Should return empty string for null or blank input")
    void testNormalize_NullOrBlank() {
        assertEquals("", DateFormatNormalizer.normalize(null));
        assertEquals("", DateFormatNormalizer.normalize(" "));
    }
}